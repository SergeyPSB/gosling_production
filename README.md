# Результаты бекенда

Сервер был написан на python + fast api

Было реализовано 5 post запросов, также данный сервис был задеплоен на yandex cloud для более быстрого доступа.
Данные замоканные, но приближенные к реальности и взятые из уже проведенных игр, попутно был написан скрипт, позволяющий парсить файлы с аналогичным форматом данных и сохранять их в базу данных - postgresql.

Не успели поднять домен и настроить сертификат https, для более безопасного доступа к сервису в публичной сети интернета.

### Запросы

1) Запрос на создание новой игровой сессии - http://158.160.162.38/create_session

Обязательные параметры:

Отсутствуют

Возращает: 

session_code - integer;

2) Запрос на выход из игровой сессии - http://158.160.162.38/leave_session

Обязательные параметры:

session_code - integer;

Возращает: 

результат успеха или нет

3) Запрос на получение игрового конфига - http://158.160.162.38/get_config

Запрос необходим для начала игры, возвращает стартовое событие, стартовое время и карту, состоящую из ячеек

Обязательные параметры: 

session_code - integer

Возвращает: 

event - object, стартовое событие;

timmer - string, стартовое время; 

map - array of objects, список ячеек с типом эффектов и ценой по времени;

Вариант ответа:

```json
{
    "event": {
        "id": 1000,
        "description": "Сегодня четверг релизной недели, Вы - тестировщик в команде Core Android. Для одной из ваших фич, которая еще на предыдущей неделе была подлита в девелоп, вы недавно изменили значение тоггла для беты и решили посмотреть состояние бета-сборки в firebase. По вашему тогглу проблем не обнаружено, но в ходе мониторинга вы обнаруживаете необычную динамику одного краша на продовых сборках (см. скрин ниже). Какие ваши действия?",
        "image": [
            "1.png"
        ],
        "is_final": 0,
        "actions": [
            {
                "id": 1,
                "description": "Завести инцидент",
                "price": -15,
                "next_event_id": 1001,
                "is_finish": false
            },
            ...
            {
                "id": 2,
                "description": "Попробовать воспроизвести проблему",
                "price": -30,
                "next_event_id": 1002,
                "is_finish": false
            },
        ]
    },
    "timmer": "02:10",
    "map": [
        {
            "type": "neutral",
            "price": 0
        },
        {
            "type": "negative",
            "price": -20
        },
        ...
        {
            "type": "neutral",
            "price": 0
        },
        {
            "type": "negative",
            "price": -45
        }
    ]
}
```

4) Запрос для синхранизации ответа и получение информации о следующем событии - http://158.160.162.38/answer

Обязательные параметры: 

session_code - integer;

event_id - integer; 

action_id - integer;

Возвращает: 

next_event_id - integer, следующее новое событие;

is_final - integer, финальное ли было событие; 

new_time - string, время, которое посчиталось после данного ответа, нужно чтобы отобразить на UI;

Вариант ответа:

```json
{
    "next_event_id": 1002,
    "is_final": 0,
    "new_time": "01:40"
}
```

5) Запрос на движение игрока - http://158.160.162.38/move

Запрос отправляется после броска кубика, для того чтобы узнать эффект ячейки, на которую встанет и новое событие, которое произойдет после хода

Обязательные параметры: 

session_code - integer;

next_event_id - integer;

position - integer;

Возвращает: 

event - object, новое событие; 

field - object, ячейка на которую перешел пользователь;

new_time - время, которое посчиталось после перехода;

Вариант ответа:

```json
{
    "event": {
        "id": 1002,
        "description": "У вас не получилось быстро воспроизвести проблему",
        "image": [
            ""
        ],
        "is_final": 0,
        "actions": [
            {
                "id": 7,
                "description": "Попросить помощи у разработчиков Core",
                "price": -30,
                "next_event_id": 1007,
                "is_finish": false
            }
        ]
    },
    "field": {
        "type": "neutral",
        "price": 0,
        "description": ""
    },
    "new_time": "01:40"
}
```
